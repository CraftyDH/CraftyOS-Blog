<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Take 2, a fresh start... | CraftyOS Blog</title>
<meta name=keywords content>
<meta name=description content="Why must I restart? Well quite simply UEFI is a pain. But seriously I spend 72 hours rewriting and rewriting my interrupt handlers to no avail. I believe that the problem was that I could not setup paging correctly and as such caused general protection faults and as I could not handle these faults I wasted so much time. Therefore in order to catch up to my schedule I have chosen to follow Philipp Oppermann&rsquo;s blog_os to completion and then implement the other features on top.">
<meta name=author content="CraftyDH">
<link rel=canonical href=https://craftydh.github.io/CraftyOS-Blog/posts/restart/>
<link crossorigin=anonymous href=/CraftyOS-Blog/assets/css/stylesheet.min.6cba0d81b5f3f42bb578d49f402ba4175aa72b43def148780b8ad714c957c6f5.css integrity="sha256-bLoNgbXz9Cu1eNSfQCukF1qnK0Pe8Uh4C4rXFMlXxvU=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/CraftyOS-Blog/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://craftydh.github.io/CraftyOS-Blog/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://craftydh.github.io/CraftyOS-Blog/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://craftydh.github.io/CraftyOS-Blog/favicon-32x32.png>
<link rel=apple-touch-icon href=https://craftydh.github.io/CraftyOS-Blog/apple-touch-icon.png>
<link rel=mask-icon href=https://craftydh.github.io/CraftyOS-Blog/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.88.1">
<meta property="og:title" content="Take 2, a fresh start...">
<meta property="og:description" content="Why must I restart? Well quite simply UEFI is a pain. But seriously I spend 72 hours rewriting and rewriting my interrupt handlers to no avail. I believe that the problem was that I could not setup paging correctly and as such caused general protection faults and as I could not handle these faults I wasted so much time. Therefore in order to catch up to my schedule I have chosen to follow Philipp Oppermann&rsquo;s blog_os to completion and then implement the other features on top.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://craftydh.github.io/CraftyOS-Blog/posts/restart/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-08-22T00:00:00+00:00">
<meta property="article:modified_time" content="2021-08-22T00:00:00+00:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Take 2, a fresh start...">
<meta name=twitter:description content="Why must I restart? Well quite simply UEFI is a pain. But seriously I spend 72 hours rewriting and rewriting my interrupt handlers to no avail. I believe that the problem was that I could not setup paging correctly and as such caused general protection faults and as I could not handle these faults I wasted so much time. Therefore in order to catch up to my schedule I have chosen to follow Philipp Oppermann&rsquo;s blog_os to completion and then implement the other features on top.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://craftydh.github.io/CraftyOS-Blog/posts/"},{"@type":"ListItem","position":2,"name":"Take 2, a fresh start...","item":"https://craftydh.github.io/CraftyOS-Blog/posts/restart/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Take 2, a fresh start...","name":"Take 2, a fresh start...","description":"Why must I restart? Well quite simply UEFI is a pain. But seriously I spend 72 hours rewriting and rewriting my interrupt handlers to no avail. I believe that the problem was that I could not setup paging correctly and as such caused general protection faults and as I could not handle these faults I wasted so much time. Therefore in order to catch up to my schedule I have chosen to follow Philipp Oppermann\u0026rsquo;s blog_os to completion and then implement the other features on top.","keywords":[],"articleBody":"Why must I restart? Well quite simply UEFI is a pain. But seriously I spend 72 hours rewriting and rewriting my interrupt handlers to no avail. I believe that the problem was that I could not setup paging correctly and as such caused general protection faults and as I could not handle these faults I wasted so much time. Therefore in order to catch up to my schedule I have chosen to follow Philipp Oppermann’s blog_os to completion and then implement the other features on top. In order to prevent my assignment from being strait up plagiarism, I will add more features and things to my OS.\nRevised Timeline As I now must have a blog post each week, I have revised the schedule to be a weekly schedule.\n Writing a rust BIOS application  VGA Text Mode A testing suite   Exceptions and Interrupts  IDT / GDT Exception Handlers Timer Handler Keyboard Handler   Paging / Memory  Map Physical Memory Heap Allocator   Cooperative Multitasking  Futures Async Keyboard   PCI / USB  Show all PCI and USB devices Get inputs from USB bus   Devices  USB Keyboard PS2 and USB Mouse   Storage  Read/Write raw bytes to hard drive   Filesystem  Program a basic filesystem such as Fat32   Networking  Raw Ethernet Frames ICMP   More Networking  TCP UDP   Terminal and Other applications  For the remaining time…    Writing a rust BIOS application As iterated earlier for this week I primarily followed Phillip’s tutorial series for the beginning, however I did add a few things.\nHello World To begin any project you must write “Hello World”, therefore a VGA buffer writer would need to be made. In the tutorial Phil started from to bottom of the screen and for scroll copied everything 1 line up, however I preferred the writer starting from the top left of the screen, as you can see in the below picture.\nAs with my original attempt I created a colour! macro to change which colour is printed to the screen which is now limited to VGA colours. Along with that I implemented a cursor! macro to change the writers cursor position on the screen. Both of these features are shown bellow where I wrote some pink text at the bottom of the screen.\nTesting Thankfully, the boot-loader crate that I have been using from Phillip’s tutorial includes a test runner hook. The required items to complete the test suite were, a serial printer in order to print results back the the QEMU host, a bunch of tests and rewriting the OS to create standalone tests to prevent regressions. As the tutroial covered this very well I didn’t add very much except for modularizing the code into a different directory structure. As shown in the below image the test suite prints the result of each test to the console via QEMU’s serial interface, unforntantlyunfortunately there are errors however those are from the bootloader crate and as such I can’t do anything about them.\n","wordCount":"487","inLanguage":"en","datePublished":"2021-08-22T00:00:00Z","dateModified":"2021-08-22T00:00:00Z","author":{"@type":"Person","name":"CraftyDH"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://craftydh.github.io/CraftyOS-Blog/posts/restart/"},"publisher":{"@type":"Organization","name":"CraftyOS Blog","logo":{"@type":"ImageObject","url":"https://craftydh.github.io/CraftyOS-Blog/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<noscript>
<style type=text/css>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://craftydh.github.io/CraftyOS-Blog/ accesskey=h title="CraftyOS Blog (Alt + H)">CraftyOS Blog</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://craftydh.github.io/CraftyOS-Blog/archives title=Archive>
<span>Archive</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<h1 class=post-title>
Take 2, a fresh start...
</h1>
<div class=post-meta>August 22, 2021&nbsp;·&nbsp;CraftyDH
</div>
</header>
<div class=post-content><h2 id=why-must-i-restart>Why must I restart?<a hidden class=anchor aria-hidden=true href=#why-must-i-restart>#</a></h2>
<p>Well quite simply UEFI is a pain. But seriously I spend 72 hours rewriting and rewriting my interrupt handlers to no avail. I believe that the problem was that I could not setup paging correctly and as such caused general protection faults and as I could not handle these faults I wasted so much time. Therefore in order to catch up to my schedule I have chosen to follow Philipp Oppermann&rsquo;s <a href=https://os.phil-opp.com/>blog_os</a> to completion and then implement the other features on top. In order to prevent my assignment from being strait up plagiarism, I will add more features and things to my OS.</p>
<h2 id=revised-timeline>Revised Timeline<a hidden class=anchor aria-hidden=true href=#revised-timeline>#</a></h2>
<p>As I now must have a blog post each week, I have revised the schedule to be a weekly schedule.</p>
<ol>
<li>Writing a rust BIOS application
<ul>
<li>VGA Text Mode</li>
<li>A testing suite</li>
</ul>
</li>
<li>Exceptions and Interrupts
<ul>
<li>IDT / GDT</li>
<li>Exception Handlers</li>
<li>Timer Handler</li>
<li>Keyboard Handler</li>
</ul>
</li>
<li>Paging / Memory
<ul>
<li>Map Physical Memory</li>
<li>Heap Allocator</li>
</ul>
</li>
<li>Cooperative Multitasking
<ul>
<li>Futures</li>
<li>Async Keyboard</li>
</ul>
</li>
<li>PCI / USB
<ul>
<li>Show all PCI and USB devices</li>
<li>Get inputs from USB bus</li>
</ul>
</li>
<li>Devices
<ul>
<li>USB Keyboard</li>
<li>PS2 and USB Mouse</li>
</ul>
</li>
<li>Storage
<ul>
<li>Read/Write raw bytes to hard drive</li>
</ul>
</li>
<li>Filesystem
<ul>
<li>Program a basic filesystem such as Fat32</li>
</ul>
</li>
<li>Networking
<ul>
<li>Raw Ethernet Frames</li>
<li>ICMP</li>
</ul>
</li>
<li>More Networking
<ul>
<li>TCP</li>
<li>UDP</li>
</ul>
</li>
<li>Terminal and Other applications
<ul>
<li>For the remaining time&mldr;</li>
</ul>
</li>
</ol>
<h2 id=writing-a-rust-bios-application>Writing a rust BIOS application<a hidden class=anchor aria-hidden=true href=#writing-a-rust-bios-application>#</a></h2>
<p>As iterated earlier for this week I primarily followed Phillip&rsquo;s tutorial series for the beginning, however I did add a few things.</p>
<h3 id=hello-world>Hello World<a hidden class=anchor aria-hidden=true href=#hello-world>#</a></h3>
<p>To begin any project you must write &ldquo;Hello World&rdquo;, therefore a VGA buffer writer would need to be made. In the tutorial Phil started from to bottom of the screen and for scroll copied everything 1 line up, however I preferred the writer starting from the top left of the screen, as you can see in the below picture.</p>
<p><img loading=lazy src=helloworld.png alt="hello world screenshot" title="Hello World screenshot">
</p>
<p>As with my original attempt I created a <code>colour!</code> macro to change which colour is printed to the screen which is now limited to VGA colours. Along with that I implemented a <code>cursor!</code> macro to change the writers cursor position on the screen. Both of these features are shown bellow where I wrote some pink text at the bottom of the screen.</p>
<p><img loading=lazy src=pink.png alt="pink text screenshot" title="pink text screenshot">
</p>
<h3 id=testing>Testing<a hidden class=anchor aria-hidden=true href=#testing>#</a></h3>
<p>Thankfully, the boot-loader crate that I have been using from Phillip&rsquo;s tutorial includes a test runner hook. The required items to complete the test suite were, a serial printer in order to print results back the the QEMU host, a bunch of tests and rewriting the OS to create standalone tests to prevent regressions. As the tutroial covered this very well I didn&rsquo;t add very much except for modularizing the code into a different directory structure. As shown in the below image the test suite prints the result of each test to the console via QEMU&rsquo;s serial interface, unforntantlyunfortunately there are errors however those are from the bootloader crate and as such I can&rsquo;t do anything about them.</p>
<p><img loading=lazy src=testing.png alt="testing screenshot" title="testing screenshot">
</p>
</div>
<footer class=post-footer>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2021 <a href=https://craftydh.github.io/CraftyOS-Blog/>CraftyOS Blog</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)">
<button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</button>
</a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>